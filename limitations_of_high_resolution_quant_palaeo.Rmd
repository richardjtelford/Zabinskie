---
title: "The limits of high-resolution palaeoecology"
author: |
  | Richard J. Telford 
  | Department of Biology, University of Bergen, Postboks 7803, N-5020 Bergen
  | email: richard.telford@uib.no
date: "`r format(Sys.Date(), '%d %B %Y')`"
header-includes:
   - \usepackage{lineno}
   - \linenumbers
   - \usepackage{pdflscape}
   - \newcommand{\blandscape}{\begin{landscape}}
   - \newcommand{\elandscape}{\end{landscape}}   
#output:
#  word_document: default
#  html_document: default
#  pdf_document: default
output:
  pdf_document:
      latex_engine: xelatex
#csl: journal-of-paleolimnology.csl
bibliography: chironomid.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, cache = TRUE, cache.lazy=TRUE)

options(digits = 2)

library("tidyverse")
library("readxl")
library("sp")
library("english")
library("rioja")
library("vegan")
library("ggvegan")
library("laketemps")
library("assertthat")
library("magrittr")
library("directlabels")
library("readr")
library("palaeoSig")
library("zoo")
library("nlme")
library("xml2")
#"analogue", english, stringi also needed

#helper functions
as.english <- function(x){ # problem with new version of rmarkdown
  as.character(english::as.english(x))
  }
as.English <- function(x){ #sentence case
  stringi::stri_trans_totitle(as.character(as.english(x)), opts_brkiter = stringi::stri_opts_brkiter(type = "sentence"))
  }

#requires analogue, gridextra, assertthat, palaeoSig

knitr::read_chunk("scripts/pages2k.R")
knitr::read_chunk("scripts/load_zabinskie_data.R")
knitr::read_chunk("scripts/regional_composite.R")
knitr::read_chunk("scripts/correlation_in_space.R")
knitr::read_chunk("scripts/weather_climate.R")
knitr::read_chunk("scripts/percent_variance_by_month.R")
knitr::read_chunk("scripts/age_uncertainty.R")
knitr::read_chunk("scripts/reconstruction_diagnostics.R")
knitr::read_chunk("scripts/regional_composite.R")
knitr::read_chunk("scripts/zabinskie_temperature_composite.R")
knitr::read_chunk("scripts/air_water_correlation.R")
knitr::read_chunk("scripts/ordinations.R")
knitr::read_chunk("scripts/figure2_ordination.R")
knitr::read_chunk("scripts/effect_low_counts.R")
knitr::read_chunk("scripts/curiousCounts.R")
knitr::read_chunk("scripts/calibration_set_issues.R")
knitr::read_chunk("abisko/scripts/abisko_short_2003.R")
knitr::read_chunk("silvaplana/scripts/silvaplana_load.R")
knitr::read_chunk("silvaplana/scripts/seebergsee_occur.R")
knitr::read_chunk("seebergsee/seebergsee_counts.R")
knitr::read_chunk("seebergsee/seeberg_climate.R")
knitr::read_chunk("zhang_et_al/zhang_et_al.R")

Zabinskie <- "Żabińskie" #avoid upsetting spell checker with special characters
```

```{r load_Zabinskie_data, include = FALSE}
```

## todo

write - zabinskie ordination. long axes, misreported % explained. interpretation.
Write - count based uncertainties based on calibration set resampling  

## Highlights

 - Subdecadal resolution reconstructions based on microfossil assemblage composition are reviewed.
 - Ecological and taphonomic processes and chronological uncertainty mean that only in favourable circumstances will precise reconstructions be possible.
 - Condition seem favourable for reconstructing recent changes in lake nutrient status with diatoms.
  - Conditions are not favourable for subdecadal chironomid-temperature reconstrucions.
  - Serious problems with most of the subdecadal chironomid-temperature reconstrucions are discussed.
  - Chrysophyte-based reconstructions are difficult to evaluate due to a dearth of archived data.

## Abstract

Very high, even annual, resolution quantitative palaeoenvironmental reconstructions are being generated from microfossil data with transfer functions. I show that at these resolutions some ecological and taphonomic issues can become more problematic than with work at lower resolution. I suggest which types of proxy-environment cases are likely to perform better and demonstrate that the exceptionally good performance in several published reconstructions is probably not reproducible.

**Keywords:** air temperature, chironomids, microfossils, quantitative palaeoenvironmental reconstructions, transfer functions

## Introduction

```{r pages2k}
```

Palaeoecologists and others value high-resolution palaeolimnological data [@Perga2015, @Pages2013]. Of the `r nrow(lakesHi)` very high resolution palaeolimnological time series in the Pages2k Consortium's [-@Pages2017] compilation of temperature-sensitive proxy records, most are the thickness or other physical property of the varves, which can be difficult to interpret [@Blass2007], while only `r sum(lakesHi$proxy %in% c("chironomid", "BSi")) %>% as.english()` series are of biological proxies: `r sum(lakesHi$proxy %in% c("chironomid")) %>% as.english()` chironomid-inferred temperature series and a `r stopifnot(sum(lakesHi$proxy == "BSi") == 1)` biogenic silica series. 

The two chironomid records are part of a growing move towards subdecadal-resolution microfossil-based reconstructions using transfer functions. As such records require large investments of time, it is important to understand the circumstances in which they are likely to yield good results. Evidence for the utility of these high, even annual, resolution reconstructions comes from comparisons of instrumental records with the reconstructions, typically from varved sediments. All sub-decadal microfossil-based reconstruction identified by a literature search are listed in Table 1. Lotter [-@Lotter1998] and Alefs and Müller [-@Alefs1999] reconstruct total phosphorous concentrations from annually-resolved, mainly planktic, lacustrine diatom assemblages. In all three lakes studied, the reconstructed nutrient concentration has a good correlation with the slowly varying monitoring data (Table 1). High-resolution chrysophyte stomatocysts stratigraphies have been used to reconstruct winter conditions as reflected by the date of spring mixing [@DeJong2011] and the duration of cold water [-@HernandezAlmeida2015]. Since there are no long instrumental time series of these limnological variables, the reconstructions are correlated with winter air temperatures. Chrysophyte stomatocysts have also been used to reconstruct summer calcium concentrations [@HernandezAlmeida2015b], which might reflect summer mixing and so were correlated with summer wind speeds. High-resolution chironomid head capsules stratigraphies have been used to reconstruct summer air temperatures [@Larocque2009; @Larocque-Tobler2011; @LarocqueTobler2011b;  @Larocque-Tobler2015; @Luoto2016; @Zhang2017]. Some of the correlations shown in Table 1 are surprisingly good given the ecological sensitivity of the proxy, taphonomic issues, and the inherent chronological uncertainty that occurs even in the best dated palaeolimnological records.

\blandscape

```{r table1}
studies <- read.table(header = TRUE, sep = ";", text = 
"Study;Proxy;Variable;Location;Resolution;Correlation
Lotter [-@Lotter1998];Diatoms;Total phosphorus;Baldegersee, Switzerland;Annual;\'compares well\'*
Alefs and Müller [-@Alefs1999];Diatoms;Total phosphorus;Ammersee, Germany;Annual;0.91* 
  ;  ;  ;Starnberger See, Germany;Annual;0.77*

De Jong and Kamenik [-@DeJong2011];Chrysophytes;Date of spring mixing;Lake Silvaplana, Switzerland; Annual (3 yr smooth);–0.58 vs mean Oct.--May air temperature*
Hernández-Almeida et al. [-@HernandezAlmeida2015b];Chrysophytes;Calcium concentrations;Lake Żabińskie, Poland;Annual (3 yr smooth);0.5 vs May--Oct. zonal wind speed*
Hernández-Almeida et al. [-@HernandezAlmeida2015];Chrysophytes;Number consecutive days with water < 4°C;Lake Żabińskie, Poland;Annual smoothed?;0.35 vs Jan.--March air temperature*

Larocque and Hall [-@Larocque2003];Chironomids;July air-temperature;Lake Njulla, Sweden;2--7 years;0.39
   ;  ;  ;Lake 850;2--6 years;0.365
  ;  ;  ;Alanen Laanijavri;1--5 years;0.35
  ;  ;  ;Vuoskkujavri;1--6 years;0.37
Larocque et al. [-@Larocque2009], Larocque-Tobler et al. [-@Larocque-Tobler2011];Chironomids;July air-temperature;Lake Silvaplana, Switzerland;Near annual;0.65/0.53*
Larocque-Tobler et al. [-@LarocqueTobler2011b];Chironomids;July air-temperature;Seebergsee, Switzerland;3--8 yrs;0.64/0.73
'Larocque-Tobler et al. [-@Larocque-Tobler2015; -@Larocque-Tobler2016]';Chironomids;August air-temperature;Lake Żabińskie, Poland;Mostly annual;0.76*
Luoto and Ojala [-@Luoto2016];Chironomids;July air-temperature;Nurmijärvi, Finland;1--11 years;0.38/0.51*
Zhang et al. [-@Zhang2017];Chironomids;July air-temperature;Tiancai Lake, China;1--4 years;0.45
Lang et al. [-@Lang2017];Chironomids;July air-temperature;Speke Hall Lake, UK; ~8 years;0.62", stringsAsFactors = FALSE )

#studies %>% kable(caption = "Location, proxy, resolution and correlation of with the instrumental record of the reconstructions considered. Where two numbers are given for the correlation, the first is the correlation for a calibration-in-space model, the second a calibration-in-time model. Asterisks indicate lakes with varve chronologies.") %>% column_spec(column)

pander::pander(studies, caption = "Location, proxy, resolution and correlation of with the instrumental record of the reconstructions considered. Where two numbers are given for the correlation, the first is the correlation for a calibration-in-space model, the second a calibration-in-time model. Asterisks indicate lakes with varve chronologies.", split.cells = 25, split.tables = 150)
```

\elandscape

The performances of several of the chironomid reconstructions are comparable with the best treering-width--climate correlations where the 99^th^ percentile of statistically significant (p < 0.05) correlations is 0.7 for winter precipitation and 0.63 for summer temperature [@StGeorge2014]. Although the treering-width--climate relationship has its complexities [@DArrigo2008], it is much simpler than the multi-species relationship between microfossil assemblages and climate, has no chronological error, and no taphonomic complications.  

Here, I consider the ecological, chronological and taphonomic issues faced by sub-decadal resolution reconstructions with a focus on chironomid-based reconstructions as these reconstructions, which have exceptional correlations with instrumental data, are from contrasting lakes. For example, lakes  `r Zabinskie` [@Larocque-Tobler2015], Nurmijärvi [@Ojala2013] and Seebergsee [@LarocqueTobler2011b] have anoxic hypolimnia, at least seasonally, whereas anoxia is not reported for the lakes Silvaplana [@Larocque2009; @Larocque-Tobler2011], Tiancai [@Zhang2017], or the four lakes near Abisko [@Larocque2003]. Lake Silvaplana underwent human-induced eutrophication and recovery during the 20th century [@Bigler2007].

The best correlation between chironomid-inferred temperature and the instrumental record is in Larocque-Tobler et al. [-@Larocque-Tobler2015], so this study is the focus of this review. Larocque-Tobler et al. [-@Larocque-Tobler2015] reconstruct August air temperature since 1896 at ~annual resolution from chironomid in the varved Lake `r Zabinskie`, using a combined Polish-Canadian calibration set. Many other studies on this lake [@Amann2014; @Bonk2015; @Bonk2015a; @Bonk2016; @Tylmann2016; @Witak2017] provide supporting information which aids the interpretation of this reconstruction.

?????#importance of reproducibility#?????

### Ecological sensitivity 

With the exception of the diatom-total phosphorus reconstructions, all the work cited in Table 1 is attempting to reconstruct climate for part of a year, most often air temperature from a single month in summer. It is possible to conceive of a biological proxy that is sensitive to, and only to, a single month's temperature. Such a proxy would need to have a short generation time, so it can rapidly respond to temperatures in that month, and to live mainly within that month and be dormant throughout the remainder of the year. It is not clear that any proxy meets these ideal standards, but bloom-forming algae such as chrysophytes might, at least in some lakes. Chironomids would seem to fall far short of these ideals, with the larvae taking months, or even years, to mature [@Tokeshi1995].

Larocque-Tobler et al. [-@Larocque-Tobler2015] reconstruct August air temperature because this variable explains the most variance in a Canadian calibration set [@Larocque2006]. While it is widely believed [@Eggermont2011] that summer air temperature is a key variable affecting chironomid assemblages, there is no particular reason to suspect August temperatures to be uniquely important. It is, for example, not the warmest month in Lake `r Zabinskie` [@Bonk2015]. The phenology of chironomid emergence [@Tokeshi1995] suggests that many chironomids will have emerged before August, precluding August temperatures of their assigned year from having any influence, a problem recognised by Larocque-Tobler et al. [-@LarocqueTobler2012]. At Polish latitudes, many of the chironomids in shallow water are likely to be bivoltine [@Tokeshi1995] with two generations a year. Their first generation of adults, along with some univoltine species from deeper water, will emerge in spring [@Tokeshi1995] and so might be influenced by the previous year's August temperatures, introducing a lagged response. Their second generation, emerging in late summer/autumn [@Tokeshi1995], will be affected by August temperatures but also temperatures throughout the summer and by the original species composition of the eggs. 


```{r correlation_in_space, results = "hide", fig.keep='none'}
```
```{r regional_composite, results = "hide", fig.keep='none'}
```


With a few exceptions [@Larocque-Tobler2011; @LarocqueTobler2011b; @Luoto2016], transfer-function models for quantitative palaeoclimate reconstructions are calibrated on a spatial calibration set of sites with  paired microfossil and climatological normals [@Birks2010]. Over a spatial calibration set, the correlation between air temperature in different months can be expected to be high. For example, in the Polish-Canadian chironomid calibration set, the correlation between June and August mean air temperatures [@Fick2017] is `r cor(climate$Jun, climate$Aug, use = "pair")`, and the Pearson correlation between August and mean summer (JJA) air temperatures is `r cor(climate$summer, climate$Aug, use = "pair")`. Hence, it makes little difference if we calibrate the model against June, August or mean summer temperatures, as the model performance statistics will be very similar (Fig 1a-b) and the reconstructions will all have a similar shape (Fig. 2). Any of these months can be reconstructed, provided the assumption that the relationship between monthly temperatures is invariant across time [@Juggins2013], but it makes sense to try to reconstruct temperature for the most ecologically important time of year. 

The choice of calibration target, however, has a large impact on the correlation between the reconstruction and the instrumental data (Fig. 1c). The correlation between June and August air temperature in a regional composite (similar to that used in Larocque-Tobler et al. [-@Larocque-Tobler2015]) in the period 1896-2010, is only `r cor(fat_composite$Aug, fat_composite$Jun)`. The correlation between mean summer air temperature and August air temperature in the same composite is `r cor(fat_composite$Aug, fat_composite$summer)`. This is as good a correlation as can be expected for predicting August temperature from mean summer data collected with a thermometer. This problem is time-scale dependent: if temperature is averaged over several years, as would be typical for a low- to medium-resolution palaeoecological analysis, the correlation between June and August temperatures, or August and the whole summer increases because radiative forcing or long-term internal variability such as the Atlantic Multidecadal Oscillation [@Schlesinger1994] tends to warm the whole season and weather-related variability is suppressed (Fig. 3). 


```{r percent_variance, message  = FALSE, results = "hide", fig.keep='none'}
```
```{r plot_explained_variance, fig.cap = "By month, a) the percent of intertia explained in a cannonical correspondence analysis CCA constrained by temperature, b) transfer function cross-validation r^2^ calibrated against temperature, c) correlation between the predicted temperature and the instrumental temperature"}
variance_plot 
```

```{r reconstruction_by_month}
```

```{r plot_recon_by_month, fig.cap = "Reconstruction of temperature for different months at Lake Żabińskie"}
recon_by_month_plot
```

```{r weather_climate, results = "hide", fig.keep='none'}
```
```{r weather_climate_plot, fig.cap = "Correlation between August and June (blue line), and August and summer temperatures (red line) averaged over different length periods in the central England temperature series [@Parker1992]"}
JuneAugustSummer_plot
```


```{r calculate_lake_air_correlations}
```
Chironomids are probably more sensitive to water temperature than air temperature directly [@Eggermont2011], and transfer-function models reconstructing air temperature depend on the strong relationship between air and water temperature. Air temperature is the most important determinant of water temperature [@OReilly2015] but other factors such as wind speed and cloudiness also have an influence, so the inter-year correlation between air and water temperature is less than one. In Lake Zurich, this correlation is 0.67 in July [@Livingstone1998], varies between 0.59 and 0.76 for mean summer temperatures in eight Austrian lakes [@Livingstone2001], and is about 0.75 throughout the summer in the small Plusssee in northern Germany [@Rosner2012]. An analysis of summer lake and air temperatures compiled by Sharma et al. [-@Sharma2015] shows that for small (area < `r max_area`km^2^), deep (mean depth > `r min_depth`m) mid- to high-latitude lakes, the median correlation is `r median(correlations$correlation)` (n = `r nrow(correlations)`). This correlation is as good as should be expected when comparing a thermometer in the lake with the instrumental air temperature.

While temperature undoubtedly has a strong effect on chironomid physiology, growth, and community structure, at least some of the apparent effect of temperature on chironomid assemblages in the calibration set is due to indirect effects of temperature [@Eggermont2011] acting through, for example, the relationship between temperature and productivity [@Velle2010] or dissolved organic carbon [@Larocque2001]. These indirect effects will tend to strengthen the relationship between chironomid assemblages and temperature in the calibration set, but cannot be expected to fully operate on a monthly basis. As such the cross-validation performance of the transfer function will tend to overestimate the model's predictive power on short time-scales.

Conversely, ecologically important variables such as nutrient status [@Amann2014, @Witak2017] and anoxia [@Bonk2015] have changed over time in Lake `r Zabinskie` independently of August temperatures. Chironomids will have responded to these variables [@Eggermont2011], biasing the temperature reconstruction [@Juggins2013].

### Taphonomic processes

A strong correlation between an annual-resolution reconstruction and instrumental data can only be achieved if most of the microfossils in the sediment attributed to a given year, lived in that year. This could be achieved if the organisms lived at the core site (which might prevent the preservation of varves), or if direct deposition of planktic organisms dominated the record. The largely planktic diatom record from the varved Baldeggersee [@Lotter1998], marked by abrupt changes in the assemblages, might be an example of this second case.

By analogy with Lake De Waay [@vanHardenbroek2011], the seasonally anoxic hypolimnion [@Bonk2015] of Lake `r Zabinskie` will be inhabited by few chironomids (perhaps  _Chironomus plumosus_ which Nagell [-@Nagell1978] showed can withstand long periods of anoxia, but without feeding), and the chironomid assemblage in the centre of the lake will have been transported and redeposited from the oxygenated shallows by wave-induced turbulence or currents during seasonal mixing [@Eggermont2011]. Lake `r Zabinskie` experiences mixing in spring and late autumn [@Bonk2015]: complete mixing results in a large sediment flux to the centre of the lake [@Bonk2015], but this does not happen every year. 

The importance of intense sediment focusing in Lake `r Zabinskie` is evident in the high ^137^Cs and ^210^Pb inventories [@Tylmann2016]. The diffused ^137^Cs peaks [@Tylmann2016] indicate that not all the sediment in one varve was generated in that year. The five year spread in the Chernobyl ^137^Cs peak might give an indication of the degree of smoothing that can be expected in redeposited proxies. This is only a problem for very high resolution analyses. 

The importance of sediment reworking in transporting chironomids to the centre of Lake `r Zabinskie` is demonstrated by the high proportion (73% on average) of littoral taxa in the samples analysed [@Larocque-Tobler2015]. In Lake Silvaplana, an average of 50% of the assemblage is littoral taxa [@Larocque2009]. 

In lakes with oxic hypolimnia, there are other taphonomic and ecological processes that will degrade the proxy record. Bioturbation will mix the top few centimetres of sediment, acting as a low-pass filter. Stratigraphy can potentially be further compromised as chironomids can burrow several centimetres into the sediment [@Charbonneau1998]. Chironomids living in the hypolimion are isolated from summer temperature by the thermocline [@Livingstone1998], and cannot be expected to respond directly to it.



### Chronological precision

Reliable chronologies are essential for any proxy-proxy or proxy-instrumental data comparison [@Trachsel2016]. The impact of chronological error will depend on the magnitude of the chronological error relative to the persistence in the environmental variable being reconstructed. In cases such as the diatom reconstructions of total phosphorus [@Lotter1998; @Alefs1999], where the target environmental variable rises and declines over decades, a small chronological error will have little effect on the agreement between the reconstruction and the instrumental records. If, however, the target variable has little or no autocorrelation, as for example with the Lake `r Zabinskie` regional August air-temperature  composite which has an autocorrelation coefficient of `r ar(fat_composite$Aug, order.max = 1)$ar`, then even an error of a single year would seriously degrade the agreement.

The chronologies supporting the sub-decadal resolution reconstructions listed in Table 1 are either ^210^Pb or varve based. ^210^Pb chronologies typically have an uncertainty of 5--10 years on sediment 100 years old [@Appleby2006]. Varved chronologies are usually more precise, with a typical uncertainty of 1--3% [@OJALA2012] and allow the sediment from a single year (or known number of years) to be analysed. The error in varved chronologies tends to accumulate, becoming higher further back in time. It may be possible to correct for chronological errors in varved sediments [@Werner2015].

```{r age_uncertainty_setup}
```
```{r chron_no_extra_error}
```

The varve-based chronology for Lake `r Zabinskie` is supported by ^14^C dates, a ^137^Cs profile, and a microtephra [@Bonk2015a]. The counting uncertainty on the chronology is low: there are two possible extra varves in the mid-1960s and five possible missing varves between 1926 and 1899 CE. The impact of this uncertainty can be explored with a Monte Carlo procedure. Assuming that the probability of making a wrong decision at each uncertain varve is 1/3 and zero otherwise, the probability that the chronology is entirely correct is `r mean(simulation$mismatch == 0)`. If the reconstruction was perfect, chronological error is expected to reduce the correlation from 1 to `r mean(simulation$ag_correlation)`. This reduction is relatively small because most of the uncertainty occurs in the lower half of the record, so any error affects fewer years. Furthermore, because chironomid concentrations were low, samples before 1939 span two to `r max(-diff(recon$year)) %>% as.english()` years which reduces both the number of samples and their sensitivity to a single year's error. The expected correlation in the pre-1939 section of the record for a perfect reconstruction is `r mean(simulation$pre39_correlation)`. This is lower than the reported correlation between the reconstruction and the instrumental record (`r left_join(instrumental, recon) %>% filter(year < 1939) %$% cor(Aug, temperature)`) for this period.

### Calibration-in-time

Calibration-in-time models [@Larocque-Tobler2011; @LarocqueTobler2011b; @Luoto2016] are doubly problematic because the ecological, taphonomic, and chronological problems discussed above affect both the calibration set and the fossil data to which the transfer function is applied.

## Discussion

Some proxy-environment systems appear more promising for sub-decadal to annual resolution reconstructions. The diatom total phosphorus reconstructions [@Lotter1998; @Alefs1999] hold the most promise. The planktic diatoms are short-lived; nutrient availability has a strong control on diatom communities [@Tilman1981]; the taphonomy of sinking diatoms is relatively simple; and the slow changes in the target environmental variable mean that small chronological errors are inconsequential.

The chrysophyte-cyst climate system shares several of the advantages of the diatoms, but is less promising because the target climate variable has strong high-frequency variability so any chronological error or taphonomic mixing will degrade the reconstruction. The three-year running mean used in all the chrysophyte studies might partially mitigate the high-frequency variability. The apparently successful reconstruction of summer wind speed [@HernandezAlmeida2015b] and winter severity [@HernandezAlmeida2015] from the same lake is surprising given that these two climatic variables cannot be expected to be highly correlated. If both variables are ecologically important then the assumption [@Birks2010] that secondary environmental variables are unchanging is violated and following Juggins [-@Juggins2013], good reconstructions cannot be expected. The summer wind-speed reconstruction, relying on wind-induced upwelling of calcium to change species composition, seems particularly fragile. No data have been archived for either of these studies so their reproducibility cannot be verified.

Chironomids are the least promising of the three proxies used for sub-decadal reconstructions. In addition to the high-frequency variability in the target climatic variable, a chironomid's life-span is long relative to the month-long target variable, the taphonomy is complex as most head capsules need to be transported from the littoral zone and chironomid phenology means that many chironomids will have emerged before the summer so cannot be affected by summer temperatures in the year they emerge.

Doubts about the plausibility of annual and subdecadal resolution chironomid reconstructions do not imply that reconstructions on longer timescales [@Brooks2012] are flawed (but see Velle et al. [-@Velle2010]). At multi-decadal to centennial time scales, most of the issues discussed above are mitigated: single month and whole summer temperatures correlate well with each other as climate forcings rather than weather dominate; secondary variables such as dissolved organic carbon might correlate with climate change in time as they do in space and exert some influence on the assemblages; and lags due to taphonomic processes and phenology become largely irrelevant. It is not yet clear at what time scale the signal in the chironomid-inferred reconstruction can be expected to emerge from the noise.


## Issues with high-resolution chironomid reconstructions  

Given the high correlations between chironomid-inferred temperatures and air temperature shown in Table 1 and the severe problems such high-resolution reconstructions face, it is necessary to examine each of the reconstructions in detail to try to determine the reasons for these apparently good performances. Below, I show there are multiple problems with several of these reconstructions or their validation.

## Lake `r Zabinskie` [@Larocque-Tobler2015]

```{r reconstruction_diagnostics}
```
```{r randomTF}
```
One might expect that a reconstruction as excellent as the Lake `r Zabinskie` chironomid-temperature reconstruction would have excellent reconstruction diagnostics [@Juggins2012]. Indeed, Larocque-Tobler et al. [-@Larocque-Tobler2015] report that all the fossil samples had good or fair analogues in the modern calibration set. However, using the methods described in Larocque-Tobler et al. [-@Larocque-Tobler2015], `r sum(dist_to_analogues$dist_to_analogues > goodpoorbad[2])` of the `r nrow(fos)` fossil samples have bad analogues. Another reconstruction diagnostic, the squared residual distance [@Juggins2012], shows several samples to have a poor or very poor fit, and a test of reconstruction significance [@Telford2011] is not statistically significant (p = `r rtf$sig`). This lack of significance is reflected in the relatively weak correlation (r = ##) between principal component axis 1 of the fossil data and August air temperature reported in Larocque-Tobler et al. [-@Larocque-Tobler2015]. Perhaps we need to question the utility of these diagnostics?

```{r load_xml_temperature}
```
```{r ordinations}
```

Since both the assemblage and instrumental temperature data are available, more direct tests can be applied than the reconstruction diagnostics used above. A canonical correspondence analysis fitted to the assemblage data with August temperature as the sole predictor explains `r pc_explained`% of the variance in the assemblage data. This is statistically significant (p = `r anova_fos %>% format.pval()`) but the ratio of the constrained eigenvalue to the first unconstrained eigenvalue is far below one ($\lambda_1/\lambda_2$ = `r L1L2`) suggesting that August temperature is not the most important axis of variability in the assemblage data and hence precise reconstructions cannot be expected [@Juggins2013]. 

```{r temperature_correlation}
```

The surprisingly poor reconstruction diagnostics are not the only problematic aspect of Larocque-Tobler et al. [-@Larocque-Tobler2015]. The instrumental temperature series used by Larocque-Tobler et al. [-@Larocque-Tobler2015] was miscalculated for the period before 1939, the period in which chironomid samples were merged because of low abundances (Larocque-Tobler, pers comm). Rather than using the mean temperature for the interval corresponding to each sample, the temperature of the first year was used. Despite this, the pre-1939 section of the reconstruction has a better correlation (r = `r incorrect_correlation`) with the incorrectly calculated temperature data than with the correct temperature data (r = `r correct_correlation`).

```{r replicating_figure_2}
```
```{r supplementary_data_fig_1}
```

The two ordinations in Larocque-Tobler et al. [-@Larocque-Tobler2015] cannot be reproduced from the archived data (seven substantially different versions of the fossil data were archived before the current version). Larocque-Tobler et al. [-@Larocque-Tobler2015] Figure 2 is a principal component analysis of the calibration set. There are `r nrow(spp_all)` lakes in the calibration set (the paper reports 122) but Figure 2 shows only 103 lakes: 18 lakes have been omitted, including all `r sum(env_all > 23) %>% as.english()` lakes warmer than 23°C (Fig. 4a). The omission of these lakes makes the relationship between the chironomid assemblages and temperature appear to be stronger than it is. 

```{r LTfigure2, fig.cap = "a) Attempt to replicate Larocque-Tobler et al. [-@Larocque-Tobler2015] Figure 2. Lakes enclosed by a red circle are missing from the published figure. Axis labels indicate the percent of variance in the calibration set explained(Larocque-Tobler et al. [-@Larocque-Tobler2015] report 22.3% and 17.5%). b) Attempt to replicate Larocque-Tobler et al. [-@Larocque-Tobler2015] Supplementary Data Figure 1. The original figure has six more Canadian lakes in the lower right quadrant.", warning=FALSE}
th <- theme(legend.position = "bottom")
cowplot::plot_grid(
  fig2 + th + 
    guides(colour = guide_legend(nrow=2,byrow=TRUE)) +
    guides(shape = guide_legend(nrow=2,byrow=TRUE)),
  sdf1 + th, 
  nrow = 1, labels = c("a)", "b)"), align = "h")
```

Conversely, supplementary data figure 1 in Larocque-Tobler et al. [-@Larocque-Tobler2015], a redundancy analysis of the calibration set constrained to temperature with the fossil data added passively, has more lakes than expected (Fig. 4b). There are `r sum(sites$source != "Poland")` Canadian lakes in the calibration set (the paper reports 72) but the figure shows 78. The extra Canadian lakes are mostly in the same quadrant as the Polish lakes and falsely suggest "a similarity between the assemblages in warmer lakes in Canada and those which cover the same temperature gradient in Poland" [@Larocque-Tobler2015].


```{r count_error}
```
```{r fossil_residual_sd}
```
Larocque-Tobler et al. [-@Larocque-Tobler2015] report that the count sums in both the fossil and modern data sets were at least 50 chironomid head capsules. In a corrigendum, Larocque-Tobler et al. [-@Larocque-Tobler2016] subsequently acknowledged that many samples had lower count sums: `r as.english(length(lowCount))` of the  `r sum(sites_all$source == "Poland")` Polish lakes were removed from the calibration set and the minimum count sum for the fossil data reported as `r min(rowSums(fos_counts))`. `r as.English(round(mean(rowSums(fos_counts) < 50) * 100))` percent of fossil samples have a count sum less that that initially reported. It is well known [@Heiri2001; @Larocque2001a; @Quinlan2001] that low count sums are associated with increased uncertainty in reconstructions. The effect of low count sums on the precision of the reconstruction estimates from Lake `r Zabinskie` can be estimated by resampling the aggregated fossil counts many times to different count sums (with replacement). Figure 5 shows the standard deviation of `r nrep` weighted-averaging partial least squares (WAPLS) reconstructions for samples covering the range of count sums in Larocque-Tobler et al. [-@Larocque-Tobler2015].  

```{r count_error_plot, fig.cap="Standard deviation of WAPLS reconstuction based on samples with different count sums."}
count_error_plot
```

The expected standard deviation of the residuals between the reconstructed and instrumental temperature given the count sums is `r est_error %>% format(digits = 3)`°C. This is slightly larger than the observed residuals, `r fos_sd`°C, which is due to all sources of error. 

```{r curiousCounts}
```
The chironomid counts from Lake `r Zabinskie` are unusual. Typically the rarest species in any assemblage is represented by a single individual. In the Lake `r Zabinskie` counts, `r round(mean(min_count$min_count > 1) * 100)`% of samples have a minimum abundance greater than one. In one sample, all taxa occur at least `r max(min_count$min_count) %>% as.english()` times, in another, all counts are multiples of four. 

```{r Lac_AH}
```
The calibration set also has problems. Lac A and Lac H have identical assemblages `r stopifnot(A_equal_H)`, except that the percentages in Lac H have been multiplied by `r min_lac_H %>% format(digits = 3)` such that the sum of percent is `r rowSums_lac_AH[2]`%. The warmest Canadian lake is reported to have a mean August temperature of `r max(env)`°C which is warmer than anywhere in Quebec and adjacent areas [@Fick2017].


### Abisko lakes [@Larocque2003]

```{r reported_correlations}
```
```{r digitised, include=FALSE}
```
```{r all_lakes_plot, include = FALSE}
```

Of the four correlations, all between `r min(abisko_short$r)` and `r max(abisko_short$r)`, between chironomid inferred July air temperature and instrumental data reported by Larocque and Hall [-@Larocque2003] only one for matches the correlation of data digitised from their figure 4 -- Alanen Laanijavri. For the other lakes, the correlations are 
`r all_lakes %>% filter(lake == "Njulla") %$% cor(instrumental, reconstruction)`,
`r all_lakes %>% filter(lake == "Lake850") %$% cor(instrumental, reconstruction)`, and
`r all_lakes %>% filter(lake == "Vuoskkujavri") %$% cor(instrumental, reconstruction)`
 for Lake Njulla, Lake 850 and Vuoskkujavri, respectively. No assemblage data have been archived, so the reconstructions cannot be verified, but there are some discrepancies between the published stratigraphies and the reconstructions. Lake 850 lacks an assemblage for 1999 CE but has a reconstruction. Similarly, Lake Njulla has a reconstruction but no assemblage for 1923 CE and the converse for 1949 CE.


### Lake Silvaplana [@Larocque2009]

The chironomid-based July temperature reconstruction from Lake Silvaplana for the period 1850--2001 CE is first presented in Larocque-Tobler et al. [-@Larocque2009]. Subsequently,  Larocque-Tobler et al. [-@LarocqueTobler2009Holocene] and Larocque-Tobler et al. [-@LarocquTobler2010] published 420 and 1000 year long reconstructions which both include the 1850--2001 CE period. The three reconstructions for the last 150 years should be identical, or at least nearly so, however they are very different. Furthermore, archived reconstructions for Larocque-Tobler et al. [-@Larocque2009] and Larocque-Tobler et al. [-@LarocqueTobler2009Holocene] are different from their associated papers, giving five different reconstructions for this time interval  (Figure 6###). None of the papers include any explanation of these differences. The archived reconstructions for Larocque-Tobler et al. [@Larocque2009] and Larocque-Tobler et al. [-@LarocqueTobler2009Holocene] can largely be reconciled by allowing a chronological offset of up to 42 years (Figure ###) -- far more than the chronological uncertainty of the varve record. Remaining differences between these two archived reconstructions are nearly all integer differences. The archived reconstructions have low correlations with the instrumental data (r = ##).


```{r read_silvaplana_Holocene_fossil}
```
```{r last_sample}
last_sample <- fos_holocene %>%
  slice(nrow(fos_holocene)) %>% 
  select_if(. > 0)
```
```{r small_counts}
small_counts <- 100/apply(fos_holocene, 1, function(x)min(x[x > 0]))
```


Fossil assemblage percent data have been archived for Larocque-Tobler et al. [-@LarocqueTobler2009Holocene]. Unfortunately the count sums have not been archived but were reported to be at least 30. However the data suggest that many of the samples have much smaller counts. For example, the sample for `r min(holocene_year$YearAD)` CE has `r as.english(ncol(last_sample))` taxa with relative abundances of `r last_sample[1]`% and `r last_sample[2]`%. Given that the rarest taxa is probably represented by a single individual, it seems that this represents a count of `r 100/last_sample[1]` individuals. Inspection of Figure 3a from Larocque-Tobler et al. [-@LarocqueTobler2009Holocene], which shows the raw counts, supports this interpretation. `r as.English(sum(small_counts < 20))` of the `r nrow(fos_holocene)` samples appear to have a count of fewer than 20 head capsules. Such extremely low counts cannot be expected to yield precise reconstructions.

### Seebergsee [@LarocqueTobler2011b]

```{r seeberg_occur}
```
```{r seebergsee_digitised, fig.keep='none'}
```

No fossil data have been archived from the anoxic Seebergsee, but the raw count data from Figure 4a in Larocque-Tobler et al [-@LarocqueTobler2011b] can be digitised and samples merged to match Figure 4b. Larocque-Tobler et al [-@LarocqueTobler2011b] report that adjacent fossil samples were merged until there were at least 30 chironomids. However, `r mean(seeberg_sums$sum4 < 30) * 100`% of the merged samples have counts sums lower than 30 with a minimum count sum of `r  min(seeberg_sums$sum4) %>% as.english()`. Curiously, all chironomid counts in Figure 4a are multiples of four. Since the rarest taxa the fossil data is almost certainly present with a single individual, the probability that all counts are multiples of four is infinitesimally small (under very optimistic assumptions, the probablity that a given count is divisible by four is 0.25. The probability that all `r sum_occur` counts are divisible by four is 10^`r log10(seeberg_prob) %>% round()`^). This suggests that the counts have been multiplied by four. If so, all the count sums are below 30 `r stopifnot(all(seeberg_sums$sum < 30))` and the minimum count sum is only `r min(seeberg_sums$sum) %>% as.english()`.

```{r digitised_seebergsee_climate, fig.keep="none", results = "hide"}
```

```{r random_temperature}
```

Digitising the July instrumental temperature daa from figure 6 in Larocque-Tobler et al [-@LarocqueTobler2011b] allows the replicatablity of calibration-in-time result to be tested. The paper does not report which transfer function method was used, but a two component WAPLS model on square-root transformed assemblage data yields a reconstruction that has a correlation of `r sbs_perf$object[2, 2] ^ 0.5` with the instrumental data, identical to that reported and the reconstruction appears to be identical. However, this performance is only achieved if the model is not cross-validated. With cross-validation, which is essential to prevent overfitting and give an unbiased estimate of performance, the correlation drops to `r sbs_perf$crossval[2, 2] ^ 0.5`, and the reconstruction has no skill. The importance of cross-validation can be demonstrated by trying to reconstruct random noise: the observed correlation is exceeded by `r mean(random_perf >  performance(sbs_mod)$object[2, 2]) * 100`% of `r nrep` trials reconstructing Gaussian noise, and so cannot be considered remarkable.

```{r sbs_ca}
```

There are some other issues with Larocque-Tobler et al [-@LarocqueTobler2011b]. These include substantial discrepancies between the age-depth model shown in their figure 3 and figure 4b; difficulties reconciling the reported instrumental data with the series from Château d’Oex; and the report that the first and second axis of a correspondence analysis (CA) of the fossil data explain 45% and 27% of the inertia respectively. Replicating the CA shows that the first and second axis explain only `r eigenvals(sbs_ca)[1]/sbs_ca$tot.chi * 100`% and `r eigenvals(sbs_ca)[2]/sbs_ca$tot.chi * 100`% of the inertia.

### Nurmijärvi [@Luoto2016]

No data have been archived for Luoto and Ojala [-@Luoto2016] so it is not possible to determine if the calibration-in-time and calibration-in-space reconstructions of July air temperature in this paper are reproducible. However, the calibration-in-time model is reported as having a leave-one-out r^2^ of 0.64, whereas the reconstruction has a correlation with instrumental temperature of only 0.51 (i.e. r^2^ = `r 0.51^2`): these two performance statistics should be identical. Luoto and Ojala [-@Luoto2016] report that there is a 4--8 year lag (perhaps caused by the ecological and taphonomic processes described above) in the chironomid response to temperature, which would seem to preclude the development of a good calibration-in-time model. The number of lakes in the calibration set is variously given as 180 or 183, both higher than the sum of the number of lakes in the prior calibration sets merged for this paper. [#check references - and check in chironomid calibration sets csv#]

### Tiancai Lake [@Zhang2017]

```{r zhang_recon, include=FALSE}
```


Zhang et al. [-@Zhang2017] report that they correlate their July air temperature reconstruction with three-year moving average of the instrumental data. However, the instrumental time series have been mis-processed. Rather than using a three year moving average, the authors take the July air temperature of every third year and interpolate.  The significant correlation between the reconstruction and the interpolated triennial data can only be a Type 1 error, unless it is believed that chironomids are only sensitive to July temperature every third year and that they can predict the temperature up to two years ahead. With a three-year moving average, the correlation is weak (r = `r zhang_smo_cor$estimate`) and not statistically significant (p = `r zhang_smo_cor$p.value`).

### Speke Hall Lake [@Lang2017]

The polluted, eutrophic Speke Hall Lake [@Lang2017] is a curious choice of site on which to apply the Norwegian chironomid calibration set [@Brooks2001], conflicting with the usual guidance that sites should be within the environmental space covered by the calibration set to minimise non-analogue problems. The reported correlation between the reconstruction and instrumental data, based on sixteen samples, is statistically significant at the p < 0.05 level, but given the lack of correction for temporal autocorrelation, the inverse correlation between July temperature and most of the heavy metals measured, and the poor goodness-of-fit of several fossil samples to the calibration set, it is far more likely that the correlation is due to chance than that the reconstruction has any real skill. The correlation of the reconstruction with the long Central England Temperature series is markedly worse (r = 0.25), although chronological uncertainty in the ^210^Pb-dated record on this longer time scale probably precludes a good performance.

## Conclusions

Reliable annual-resolution reconstructions depend on the conjunction of a strong direct ecological link to the variable being reconstructed and a simple taphonomy. Accurate and precise chronologies are also needed for a direct comparison with instrumental records. These requirements might be met by diatom-total phosphorus reconstructions, and perhaps by chrysophyte reconstructions of winter climate. It appears unlikely that they will be met by the relatively long-lived, predominately littoral chironomids for reconstructions of a single month's temperature. Some of the chironomid-based reconstructions discussed above owe their apparent good performance to single fortuitous errors or simple good luck. The reconstructions from lakes `r Zabinskie`, Seebergsee, Silvaplana, and the four lakes near Abisko are plagued by such pervasive errors and improbabilities that their veracity has to be doubted until their results be confirmed by reproducing the work.

The number and severity of errors in the papers reviewed highlights the importance of archiving all the raw data needed to replicate the results.

## Methods

All analyses were done in `r gsub("(.*) \\(.*", "\\1", R.version.string)` [@R2017]. Ordinations were fitted with vegan version 2.4-3 [@vegan2017] with square-root transformed assemblage data. Transfer functions were fitted with rioja version 0.9-15 [@rioja2017] using square-root transformed species data. Some diagnostics were performed using analogue version 0.17-0 [@analogue2016]. The reconstruction significance test was run with randomTF from palaeoSig version 1.1-3 [@palaeoSig2015] with 999 trials for the null distribution.

Spatial climate data were extracted from WorldClim2 [@Fick2017]; some of the lake positions are approximate as location data have not been archived. The regional Polish temperature composite included data from Kaliningrad, Kaunas, Vilnius, and Warsaw GHCN [#] series extracted using the [KNMI Climate Explorer](https://climexp.knmi.nl/selectstation.cgi?id=someone@somewhere). The 1951-1980 mean was subtracted from each series.
  

## Acknowledgements

I thank all my colleagues in Bergen and elsewhere who have given the help, advice and encouragement needed to write this manuscript. I would especially like to thank the Integrity Officer at the University of Bern who stimulated many of these analyses. This work was partially funded by the Norwegian Research Council FriMedBio project palaeoDrivers (213607). Code to replicate all the analyses shown above is archived at [https://github.com/richardjtelford/Zabinskie](https://github.com/richardjtelford/Zabinskie).

## References